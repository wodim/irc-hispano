<?xml version="1.0"?>
<pxyscand>
  
  <opas>
    <port>9601</port>
    <bind-address>127.0.0.1</bind-address>
    <protocol>tcp</protocol>
    <allow>127.0.0.1</allow>
    <limit>0</limit><!-- requests per minute, 0=unlimited -->
  </opas>
  
  <scanner>
    <maxscans>512</maxscans>
    <!-- built-in module types: wingate,socks,crazybandit,http -->
    <!-- Solo wingate o 3com812 ya que usan el mismo puerto -->
    <module type="wingate" />
    <module type="3com812" />
    <module type="socks">1080</module>
    <module type="crazybandit" />
    <module type="http">3128</module>
    <module type="http">6588</module>
    <module type="http">8080</module>
    <module type="http">4480</module>
    <module type="http">80</module>
    <module type="http">8000</module>
    <module type="bouncerhispano">6667</module>
    <module type="tor" />
<!--
    <source-pool>
      <address>172.16.0.51</address>
      <address>172.16.0.52</address>
      <address>172.16.0.53</address>
      <address>172.16.0.54</address>
      <address>172.16.0.55</address>
    </source-pool>
-->

    
<!-- set scans pxtarget (the pxtarget daemon!) -->
    <target>
      <address>1.2.3.4</address>
      <port>9001</port>
      <secret>mysecret</secret>
    </target>
    <target>
      <address>2.3.4.5</address>
      <port>1234</port>
      <secret>myothersecret</secret>
    </target>
    <target-check>600</target-check>
    <log-agent>agent.log</log-agent>
    <timeout>30</timeout>
  </scanner>

  <dnsbl>
    <server>
      <name>Spamhaus</name>
      <domain>zen.spamhaus.org</domain>
      <reason type="2">SBL Spamhaus Maintained</reason>      
      <reason type="4">XBL CBL (Composite Block List)</reason>
      <reason type="5">XBL NJABL</reason>
      <reason type="10">PBL ISP Maintained</reason>
      <reason type="11">PBL Spamhaus Maintained</reason>
    </server>
    <server>
      <name>Ahbl DNSBL</name>
      <domain>dnsbl.ahbl.org</domain>
      <reason type="2">Open Relay</reason>
      <reason type="3">Open Proxy</reason>
      <reason type="4">Spam Source</reason>
      <reason type="5">Provisional Spam Source Listing block</reason>
      <reason type="6">Formmail Spam</reason>
      <reason type="7">Spam Supporter</reason>
      <reason type="8">Spam Supporter (indirect)</reason>
      <reason type="9">End User (non mail system)</reason>
      <reason type="10">Shoot On Sight</reason>
      <reason type="11">Non-RFC Compliant (missing postmaster or abuse)</reason>
      <reason type="12">Does not properly handle 5xx errors</reason>
      <reason type="13">Other Non-RFC Compliant</reason>
      <reason type="14">Compromised System - DDoS</reason>
      <reason type="15">Compromised System - Relay</reason>
      <reason type="16">Compromised System - Autorooter/Scanner</reason>
      <reason type="17">Compromised System - Worm or mass mailing virus</reason>
      <reason type="18">Compromised System - Other virus</reason>
      <reason type="19">Open Proxy</reason>
      <reason type="20">Blog/Wiki/Comment Spammer</reason>
      <reason type="127">Other</reason>
    </server>
    <server>
      <name>Ahbl IRCBL</name>
      <domain>ircbl.ahbl.org</domain>
      <reason type="2">Open Relay</reason>
    </server>
    <server>
      <name>Ahbl TORBL</name>
      <domain>ircbl.ahbl.org</domain>
      <reason type="2">Host running TOR</reason>
      <reason type="3">Host running a TOR exit node</reason>
      <reason type="4">Host recently seen running a TOR exit node on EFNet</reason>
    </server>
    <server>
      <name>Sorbs</name>
      <domain>dnsbl.sorbs.net</domain>
      <reason type="2">HTTP</reason>
      <reason type="3">SOCKS</reason>
      <reason type="4">Misc</reason>
      <reason type="5">SMTP</reason>
      <reason type="6">Spam</reason>
      <reason type="7">Web</reason>
      <reason type="8">Block</reason>
      <reason type="9">Zombie</reason>
      <reason type="10">Dul</reason>
      <reason type="11">Badconf</reason>
      <reason type="12">Nomail</reason>
    </server>
    <server>
      <name>DroneBL</name>
      <domain>dnsbl.dronebl.org</domain>
      <reason type="2">Sample</reason>
      <reason type="3">IRC Drone</reason>
      <reason type="4">T</reason>
      <reason type="5">Bottler</reason>
      <reason type="6">Unknown spambot or drone</reason>
      <reason type="7">DDoS Drone</reason>
      <reason type="8">SOCKS Proxy</reason>
      <reason type="9">HTTP Proxy</reason>
      <reason type="10">ProxyChain</reason>
      <reason type="11">Machines and netblocks compromised or owned by MediaDefender</reason>
      <reason type="255">Unknown</reason>
    </server>
    <server>
      <name>Sectoor</name>
      <domain>tor.dnsbl.sectoor.de</domain>
      <reason type="1">Tor exit server</reason>
    </server>
    <server>
      <name>Efnet RBL</name>
      <domain>rbl.efnetrbl.org</domain>
      <reason type="1">Open Proxy</reason>
      <reason type="2">Trojan spreader</reason>
      <reason type="3">Trojan infected client</reason>
      <reason type="4">TOR exit server</reason>
      <reason type="5">Drones / Flooding</reason>
    </server>
    <server>
      <name>NJABL</name>
      <domain>dnsbl.njabl.org</domain>
      <reason type="2">Open Relays</reason>
      <reason type="3">Dialup/dynamic ranges</reason>
      <reason type="4">Spam Sources</reason>
      <reason type="5">Multi-stage relays</reason>
      <reason type="6">Passively detected "bad hosts"</reason>
      <reason type="8">Insecure CGI scripts</reason>
      <reason type="9">Open Proxy</reason>
    </server>
    <nodnsbl>
      <country>ES</country>
    </nodnsbl>
  </dnsbl>
  
  <cache>
    <directory>ipcache</directory>
    <expire>86400</expire><!-- seconds -->
    <proxy-expire>21600</proxy-expire>
    <maxips>1000003</maxips><!-- a prime number is better -->
    <!-- http://www.utm.edu/research/primes/lists/small/100ktwins.txt -->
  </cache>
  
  <noscan>
    <address>127.0.0.1</address>
    <address>255.255.255.255</address>
    <address>0/8</address>
    <address>10/8</address>
    <address>172.16/12</address>
    <address>192.168/16</address>
  </noscan>
  
</pxyscand>
